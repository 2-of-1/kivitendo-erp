[%- USE T8 %]
[%- USE L %]
[% USE HTML %]<script type="text/javascript" src="js/FormManager.js" >
/****************************************************
* Form Dependency Manager- By Twey- http://www.twey.co.uk
* Visit Dynamic Drive for this script and more: http://www.dynamicdrive.com
****************************************************/
</script>

<script type="text/javascript">
window.onload = function() {
    setupDependencies('EditAccount'); //name of form(s). Seperate each with a comma (ie: 'weboptions', 'myotherform' )
  };
</script>

<body>
<form method="post" name="EditAccount" action="am.pl">

<input type="hidden" name="id"                 value="[% HTML.escape(id) %]">
<input type="hidden" name="type"               value="account">
<input type="hidden" name="orphaned"           value="[% HTML.escape(orphaned) %]">
<input type="hidden" name="new_chart_valid"    value="[% HTML.escape(new_chart_valid) %]">
<input type="hidden" name="original_accno"    value="[% HTML.escape(accno) %]">
<input type="hidden" name="inventory_accno_id" value="[% HTML.escape(inventory_accno_id) %]">
<input type="hidden" name="income_accno_id"    value="[% HTML.escape(income_accno_id) %]">
<input type="hidden" name="expense_accno_id"   value="[% HTML.escape(expense_accno_id) %]">
<input type="hidden" name="fxgain_accno_id"    value="[% HTML.escape(fxgain_accno_id) %]">
<input type="hidden" name="fxloss_accno_id"    value="[% HTML.escape(fxloss_accno_id) %]">

<table border="0" width="100%">
  <tr>
    <th class="listtop">[% title %]</th>
  </tr>
</table>

<fieldset>
  <legend>
    [% 'Main Preferences' | $T8 %]
  </legend>
  <table>
    <tr>
      <td>
        <label>
          [% 'Account Number' | $T8 %]
        </label></td>
        <td><input name="accno" size="20" value="[% HTML.escape(accno) %]"></td>
    </tr>
    <tr>
      <td>
        <label>
          [% 'Description' | $T8 %]
        </label>
      </td>
      <td><input name="description" size="40" value="[% HTML.escape(description) %]"></td>
    </tr>
    <tr>
      <td>
        <label>
          [% 'Chart Type' | $T8 %]

        </label>
      </td>
      <td><select name="charttype">[% select_charttype %]</select></td>
    </tr>
  </table>
</fieldset>
<fieldset class="DEPENDS ON charttype BEING A">
  <legend>[% 'Account Type' | $T8 %]</legend>
  <select name="category" id="AccountType" class="DEPENDS ON charttype BEING A">
          [% select_category %]</select>
</fieldset>

[% IF ChartTypeIsAccount %]
<fieldset class="DEPENDS ON charttype BEING A">
  <legend>[% 'Is this a summary account to record' | $T8 %]</legend>
    <input name="AR" type="checkbox" class="checkbox" value="AR" [% HTML.escape(AR) %]>
    &nbsp;[% 'AR' | $T8 %]
    <input name="AP" type="checkbox" class="checkbox" value="AP" [% HTML.escape(AP) %]>
    &nbsp;[% 'AP' | $T8 %]
    <input name="IC" type="checkbox" class="checkbox" value="IC" [% HTML.escape(IC) %]>
    &nbsp;[% 'Inventory' | $T8 %]
</fieldset>

[% IF AccountIsPosted %]
  [% IF AR_amount %] [% L.hidden_tag('AR_amount', 'AR_amount') %] [% END %]
  [% IF AR_paid   %] [% L.hidden_tag('AR_paid',   'AR_paid')   %] [% END %]
  [% IF AR_tax    %] [% L.hidden_tag('AR_tax',    'AR_tax')    %] [% END %]
  [% IF AP_amount %] [% L.hidden_tag('AP_amount', 'AP_amount') %] [% END %]
  [% IF AP_paid   %] [% L.hidden_tag('AP_paid',   'AP_paid')   %] [% END %]
  [% IF AP_tax    %] [% L.hidden_tag('AP_tax',    'AP_tax')    %] [% END %]
  [%- SET DIS = ' disabled="disabled"' %]
[% END %]
<fieldset class="DEPENDS ON charttype BEING A">
  <legend>[% 'Include in drop-down menus' | $T8 %]</legend>
  <p style='font-weight:normal'>[% 'These will only be effective if the account is NOT a summary account AND there exists at least one taxkey. Setting the account as a summary account will erase these settings.' | $T8 %]</p>
  <p style='font-weight:normal'>[% 'Changes to Receivables and Payables are only possible if no transactions to this account are posted yet.' | $T8 %]
  [% 'And if the account does not act as tax-o-matic account.' | $T8 %]</p>
  <table width="100%">
    <tr>
      <th align="left">[% 'Receivables' | $T8 %]</th>
      <th align="left">[% 'Payables' | $T8 %]</th>
      <th align="left">[% 'Parts Inventory' | $T8 %]</th>
      <th align="left">[% 'Service Items' | $T8 %]</th>
    </tr>
    <tr>
      <td>
        [% L.radio_button_tag('AR_include_in_dropdown',
          value => 'AR_amount',
          disabled => AccountIsPosted,
          checked  => AR_amount) %]
        &nbsp;[% 'Revenue' | $T8 %] <br>
        [% L.radio_button_tag('AR_include_in_dropdown',
          value => 'AR_paid',
          disabled => AccountIsPosted,
          checked  => AR_paid) %]
        &nbsp;[% 'Receipt' | $T8 %] <br>
        [% L.radio_button_tag('AR_include_in_dropdown',
          value => 'AR_tax',
          disabled => AccountIsPosted,
          checked  => AR_tax) %]
        &nbsp;[% 'Tax' | $T8 %] <br>
        [% L.radio_button_tag('AR_include_in_dropdown',
          value => '',
          disabled => AccountIsPosted) %]
        &nbsp;[% 'do not include' | $T8 %]
      </td>
      <td>
        [% L.radio_button_tag('AP_include_in_dropdown',
          value => 'AP_amount',
          disabled => AccountIsPosted,
          checked  => AP_amount) %]
        &nbsp;[% 'Expense/Asset' | $T8 %] <br>
        [% L.radio_button_tag('AP_include_in_dropdown',
          value => 'AP_paid',
          disabled => AccountIsPosted,
          checked  => AP_paid) %]
        &nbsp;[% 'Payment' | $T8 %] <br>
        [% L.radio_button_tag('AP_include_in_dropdown',
          value => 'AP_tax',
          disabled => AccountIsPosted,
          checked  => AP_tax) %]
        &nbsp;[% 'Tax' | $T8 %] <br>
        [% L.radio_button_tag('AP_include_in_dropdown',
          value => '',
          disabled => AccountIsPosted) %]
        &nbsp;[% 'do not include' | $T8 %]
      </td>
      <td>
        <input name="IC_sale" type="checkbox" class="checkbox" value="IC_sale"
          [% HTML.escape(IC_sale) %]>&nbsp;
        [% 'Revenue' | $T8 %] <br>
        <input name="IC_cogs" type="checkbox" class="checkbox" value="IC_cogs"
          [% HTML.escape(IC_cogs) %]>&nbsp;
        [% 'Expense' | $T8 %] <br>
        <input name="IC_taxpart" type="checkbox" class="checkbox" value="IC_taxpart"
          [% HTML.escape(IC_taxpart) %]>&nbsp;
        [% 'Tax' | $T8 %]
        <br><br>
      </td>
      <td>
        <input name=IC_income type=checkbox class=checkbox value="IC_income"
          [% HTML.escape(IC_income) %]>&nbsp;
        [% 'Revenue' | $T8 %] <br>
        <input name=IC_expense type=checkbox class=checkbox value="IC_expense"
          [% HTML.escape(IC_expense) %]>&nbsp;
        [% 'Expense' | $T8 %] <br>
        <input name=IC_taxservice type=checkbox class=checkbox value="IC_taxservice"
          [% HTML.escape(IC_taxservice) %]>&nbsp;
        [% 'Tax' | $T8 %]
        <br><br>
      </td>
    </tr>
  </table>
</fieldset>

<fieldset class="DEPENDS ON charttype BEING A">
  <legend>
    [% 'Taxkeys and Taxreport Preferences' | $T8 %]
  </legend>
  <p style='font-weight:normal'>[% 'Note: Taxkeys must have a "valid from" date, and will not behave correctly without.' | $T8 %]</p>

            <table>
[% IF account_exists %]
              <tr>
                <th align="left">[% 'Taxkey' | $T8 %]</th>
                <th align="left">[% 'valid from' | $T8 %]</th>
                <th align="left">[% 'pos_ustva' | $T8 %]</th>
                <th align="left">[% 'delete' | $T8 %] ? </th>
              </tr>
[% FOREACH tk = ACCOUNT_TAXKEYS %]
              <tr>
    [% IF tk.id %]
                <input type="hidden" name="taxkey_id_[% tk.runningnumber %]" value="[% tk.id %]">
                <td><select name="taxkey_tax_[% tk.runningnumber %]">[% tk.selecttaxkey %]</select></td>
                <td><input name="taxkey_startdate_[% tk.runningnumber %]" value="[% HTML.escape(tk.startdate) %]"></td>
                <td><select name="taxkey_pos_ustva_[% tk.runningnumber %]">[% tk.select_tax %]</select></td>
                <td><input name="taxkey_del_[% tk.runningnumber %]" type="checkbox"
                class="checkbox" value="delete"></td>
    [% ELSE %]
                <input type="hidden" name="taxkey_id_[% tk.runningnumber %]" value="NEW">
                <td><select name="taxkey_tax_[% tk.runningnumber %]">[% tk.selecttaxkey %]</select></td>
                <td><input name="taxkey_startdate_[% tk.runningnumber %]" value="[% HTML.escape(tk.startdate) %]"></td>
                <td><select name="taxkey_pos_ustva_[% tk.runningnumber %]">[% tk.select_tax %]</select></td>
                <td>&nbsp;</td>
    [% END %]
              </tr>

[% END %]
[% ELSE %]
<tr>
  <td align="center" colspan="4"><p>[% 'Save account first to insert taxkeys' | $T8 %]</p>
  </td>
</tr>
[% END %]
            </table>
</fieldset>

<fieldset class="DEPENDS ON charttype BEING A">
  <legend>[% 'Report and misc. Preferences' | $T8 %]</legend>
  <table>
        <tr>
          <th align="left">[% 'EUER' | $T8 %]</th>
          <td colspan="3"><select name="pos_eur">[% select_eur %]</select></td>
        </tr>
        <tr>
          <th align="left">[% 'BWA' | $T8 %]</th>
          <td colspan="3"><select name="pos_bwa">[% select_bwa %]</select></td>
        </tr>
        <!-- Diese Steuerfunktion hat keine Auswirkung in der Bilanz und wird erstmal deaktiviert. -->
        <!-- tr>
          <th align="left">[% 'Bilanz' | $T8 %]</th>
          <td colspan="3"><select name="pos_bilanz">[% select_bilanz %]</select></td>
        </tr -->
        <tr>
          <th align="left">[% 'Datevautomatik' | $T8 %]</th>
          <td colspan="3"><input name="datevautomatik" type="checkbox" class="checkbox" value="T" [% IF datevautomatik %]checked [% END %]></td>
        </tr>
        <tr>
          <th align="left">[% 'Folgekonto' | $T8 %]</th>
          <td><select name="new_chart_id">[% selectnewaccount %]</select></td>
          <th align="left">[% 'Valid from' | $T8 %]</th>
          <td><input name="valid_from" value="[% valid_from %]"></td>
        </tr>
  </table>
[% END %]
</fieldset>
<hr size="3" noshade>
