[%- USE T8 %]
[%- USE HTML %][%- USE L -%][%- USE P -%]
 <form name="Form">

  <input type="hidden" name="input_name" value="[% HTML.escape(input_name) %]">

  <div class="listtop">[% title %]</div>

  <p>[% 'Please insert your language values below' | $T8 %]</p>

  <p>
   <table>
    <tr class="listheading">
     <th class="listheading">&nbsp;</th>
     [%- FOREACH col = HEADER %]
     <th nowrap class="listheading">[% col.column_title %]</th>
     [%- END %]
    </tr>

    [%- FOREACH row = LANGUAGES %]
    <tr class="listrow[% loop.count % 2 %]">
     <td>[% L.hidden_tag("id_" _ loop.count, row.id) %][% HTML.escape(row.description) %]</td>
     <td>
       [%- IF row.translation_area %]
         [% L.textarea_tag("translation_" _ loop.count, row.translation, rows=row.translation_rows, cols="40", wrap="soft") %]
       [%- ELSE %]
         [% L.input_tag("translation_" _ loop.count, row.translation) %]
       [%- END %]
     </td>
     <td>
      [% L.textarea_tag("longdescription_" _ loop.count, P.restricted_html(row.longdescription), class="texteditor", style="width: 500px; height: 100px") %]
     </td>
    </tr>

    [%- IF loop.last %]
    <input type="hidden" id="rowcount" name="rowcount" value="[% loop.count %]">
    [%- END %]
    [%- END %]
   </table>
  </p>

  <p>
   <button type="button" onclick="languages_updated()">[% 'Close' | $T8 %]</button>
  </p>

 </form>

 <script type="text/javascript">
  <!--
      function languages_updated() {
        var languages = "";
        for (var i = 1; i <= (document.getElementsByName("rowcount")[0].value); i++) {
          var id              = "id_" + i ;
          var translation     = "translation_" + i ;
          var longdescription = "longdescription_" + i;

          languages = languages +
            "---+++---" + $('#id_' + i).val() +
            "--++--" + $('#translation_' + i).val() +
            "--++--"  + $('#longdescription_' + i).val();
        }
        console.info(languages);

        window.opener.document.getElementsByName(document.Form.input_name.value)[0].value = languages;

        self.close();
      }
      //-->
 </script>
