[% USE HTML %][% USE L %][% USE LxERP %]

 <form method="post" action="controller.pl">
  <div class="listtop">[% FORM.title %]</div>

[%- INCLUDE 'common/flash.html' %]

  <table class="rs_input_field">
   <tr>
    <td>[% LxERP.t8("Title") %]</td>
    <td>[% L.input_tag("requirement_spec.title", SELF.requirement_spec.description) %]</td>
   </tr>

   <tr>
    <td>[% LxERP.t8("Requirement Spec Type") %]</td>
    <td>[% L.select_tag("requirement_spec.type_id",  SELF.types, default=SELF.requirement_spec.type_id, title_key="description") %]</td>
   </tr>

   <tr>
    <td>[% LxERP.t8("Requirement Spec Status") %]</td>
    <td>[% L.select_tag("requirement_spec.status_id",  SELF.statuses, default=SELF.requirement_spec.status_id, title_key="description") %]</td>
   </tr>

   <tr>
    <td>[% LxERP.t8("Customer") %]</td>
    <td>[% L.select_tag("requirement_spec.customer_id",  SELF.customers, default=SELF.requirement_spec.customer_id, title_key="name", id="customer_id") %]</td>
   </tr>

   <tr>
    <td>[% LxERP.t8("Hourly Rate") %]</td>
    <td>[% L.input_tag("requirement_spec.hourly_rate_as_number", SELF.requirement_spec.hourly_rate_as_number, id="hourly_rate") %]</td>
   </tr>

  </table>

  <p>
   [% L.hidden_tag("id", SELF.requirement_spec.id) %]
   [% L.hidden_tag("action", "RequirementSpec/dispatch") %]
   [% L.submit_tag("action_" _ (SELF.requirement_spec.id ? "update" : "create"), LxERP.t8('Save')) %]
   [%- IF SELF.requirement_spec.id %]
    [% L.submit_tag("action_destroy", LxERP.t8('Delete'), confirm=LxERP.t8('Do you really want to delete this object?')) %]
   [%- END %]
   <a href="[% SELF.url_for(action="list") %]">[% LxERP.t8('Abort') %]</a>
  </p>
 </form>

 <script type="text/javascript">
  <!--
    function on_customer_changed() {
      $.ajax({
        url: 'controller.pl?action=Customer/get_hourly_rate',
        dataType: "json",
        data: { id: $("#customer_id").attr('value') },
        success: function(data) { if (data["hourly_rate"] > 0) $("#hourly_rate").attr("value", data["hourly_rate_formatted"]); }
      });
    }

    $(document).ready(function() {
      $("#customer_id").change(on_customer_changed);
    });
  -->
 </script>
